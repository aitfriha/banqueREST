name: Build and Test

on:
  push:
    branches:
      - master # Personnalisez la branche si nécessaire

jobs:
  build:
    runs-on: ubuntu-latest # Vous pouvez utiliser un autre système d'exploitation si nécessaire

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Java
      uses: actions/setup-java@v2
      with:
        distribution: 'temurin' # Choisissez la version de Java que vous utilisez
        java-version: '17'
  #  - name: Build and Push Docker Image
  #    uses: mr-smithers-excellent/docker-build-push@v6
  #    with:
  #      image: zaidid/zaidrepodocker 
  #      tags: latest_zaid_tag
  #      registry: docker.io
  #      dockerfile: Dockerfile.ci
  #      username: ${{ secrets.DOCKER_USERNAME }}
  #      password: ${{ secrets.DOCKER_PASSWORD }}
    - name: Mysql integration
      uses: mirromutth/mysql-action@v1.1
      with:
        host port: 3306 # Optional, default value is 3306. The port of host
        container port: 3306 # Optional, default value is 3306. The port of container
        character set server: 'utf8' # Optional, default value is 'utf8mb4'. The '--character-set-server' option for mysqld
        collation server: 'utf8_general_ci' # Optional, default value is 'utf8mb4_general_ci'. The '--collation-server' option for mysqld
        mysql version: '8.0' # Optional, default value is "latest". The version of the MySQL
        mysql database: 'bp' # Optional, default value is "test". The specified database which will be create
        mysql root password: ${{ secrets.RootPassword }} # Required if "mysql user" is empty, default is empty. The root superuser password
        #mysql user: 'root' # Required if "mysql root password" is empty, default is empty. The superuser for the specified database. Can use secrets, too
        #mysql password: ${{ secrets.DatabasePassword }} # Required if "mysql user" exists. The password for the "mysql user"    
    - name: Build with Maven
      run: mvn clean install

   # - name: Run Tests
   #   run: mvn test
